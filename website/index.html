<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bolajon Klinika - Sog'ligingiz bizning g'amxo'rligimiz</title>
    <meta name="description" content="Bolajon Klinika - Sifatli tibbiy xizmatlar, tajribali shifokorlar, zamonaviy uskunalar">
    <link rel="icon" type="image/jpeg" href="image.jpg">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#10b981">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Bolajon Med">
    
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <img src="image.jpg" alt="Bolajon Klinika Logo" class="logo">
                <h1>Bolajon Klinika</h1>
            </div>
            <ul class="nav-menu">
                <li><a href="#bosh">Bosh sahifa</a></li>
                <li><a href="#shifokorlar">Shifokorlar</a></li>
                <li><a href="#xizmatlar">Xizmatlar</a></li>
                <li><a href="#aloqa">Aloqa</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="bosh" class="hero">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">Sog'ligingiz bizning g'amxo'rligimiz</h1>
                <p class="hero-subtitle">Zamonaviy uskunalar va tajribali shifokorlar bilan yuqori sifatli tibbiy xizmatlar</p>
                <div class="hero-buttons">
                    <button class="btn btn-primary" onclick="scrollTo('#aloqa')">Navbatga yozilish</button>
                    <button class="btn btn-secondary" id="install-app-btn">
                        üì± Ilovani yuklab olish
                    </button>
                    <button class="btn btn-secondary" id="open-chatbot">üí¨ AI Maslahatchi</button>
                </div>
            </div>
            <div class="hero-stats">
                <div class="stat-card">
                    <h3>10+</h3>
                    <p>Tajribali shifokorlar</p>
                </div>
                <div class="stat-card">
                    <h3>5000+</h3>
                    <p>Mamnun bemorlar</p>
                </div>
                <div class="stat-card">
                    <h3>15+</h3>
                    <p>Yillik tajriba</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section id="xizmatlar" class="services">
        <div class="container">
            <h2 class="section-title">Bizning Xizmatlarimiz</h2>
            <div class="services-grid" id="services-container">
                <div class="service-card">
                    <div class="service-icon">ü©∫</div>
                    <h3>Shifokor konsultatsiyasi</h3>
                    <p>Malakali shifokorlar tomonidan to'liq ko'rik va maslahat</p>
                </div>
                <div class="service-card">
                    <div class="service-icon">üî¨</div>
                    <h3>Laboratoriya tahlillari</h3>
                    <p>Zamonaviy uskunalar bilan barcha turdagi tahlillar</p>
                </div>
                <div class="service-card">
                    <div class="service-icon">üíâ</div>
                    <h3>Muolajalar</h3>
                    <p>Ukol va tomchi muolajalar professional hamshiralar tomonidan</p>
                </div>
                <div class="service-card">
                    <div class="service-icon">üè•</div>
                    <h3>Statsionar</h3>
                    <p>Qulay palatalar va 24/7 tibbiy nazorat</p>
                </div>
                <div class="service-card">
                    <div class="service-icon">ü©π</div>
                    <h3>Davolash</h3>
                    <p>Turli kasalliklar uchun kompleks davolash</p>
                </div>
                <div class="service-card">
                    <div class="service-icon">üìä</div>
                    <h3>Diagnostika</h3>
                    <p>Zamonaviy diagnostika usullari va jihozlari</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Doctors Section -->
    <section id="shifokorlar" class="doctors">
        <div class="container">
            <h2 class="section-title">Bizning Shifokorlarimiz</h2>
            <div class="doctors-grid" id="doctors-container">
                <!-- Shifokorlar JS orqali yuklanadi -->
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="aloqa" class="contact">
        <div class="container">
            <h2 class="section-title">Biz bilan bog'laning</h2>
            <div class="contact-grid">
                <div class="contact-info">
                    <div class="info-item">
                        <span class="icon">üìç</span>
                        <div>
                            <h4>Manzil</h4>
                            <p>Toshkent shahar, Yunusobod tumani</p>
                        </div>
                    </div>
                    <div class="info-item">
                        <span class="icon">üìû</span>
                        <div>
                            <h4>Telefon</h4>
                            <p>+998 (71) 123-45-67</p>
                        </div>
                    </div>
                    <div class="info-item">
                        <span class="icon">‚è∞</span>
                        <div>
                            <h4>Ish vaqti</h4>
                            <p>Dush-Juma: 8:00 - 20:00<br>Shanba: 9:00 - 15:00</p>
                        </div>
                    </div>
                    <div class="info-item">
                        <span class="icon">üí¨</span>
                        <div>
                            <h4>Telegram Bot</h4>
                            <p><a href="https://t.me/your_clinic_bot" target="_blank">@your_clinic_bot</a></p>
                        </div>
                    </div>
                </div>
                <div class="contact-form">
                    <h3>Navbatga yozilish</h3>
                    <form id="appointment-form">
                        <input type="text" placeholder="Ism Familiya" required>
                        <input type="tel" placeholder="Telefon raqam" required>
                        <select required>
                            <option value="">Shifokorni tanlang</option>
                            <!-- Shifokorlar JS orqali yuklanadi -->
                        </select>
                        <textarea placeholder="Izoh (ixtiyoriy)"></textarea>
                        <button type="submit" class="btn btn-primary">Yuborish</button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- AI Chatbot -->
    <div id="chatbot" class="chatbot">
        <div class="chatbot-header">
            <h3>ü§ñ AI Maslahatchi</h3>
            <button id="close-chatbot">‚úï</button>
        </div>
        <div class="chatbot-messages" id="chatbot-messages">
            <div class="bot-message">
                Salom! Men sizga qanday yordam bera olaman?
            </div>
        </div>
        <div class="chatbot-input">
            <input type="text" id="chatbot-input-field" placeholder="Savolingizni yozing...">
            <button id="send-message">üì§</button>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 Bolajon Klinika. Barcha huquqlar himoyalangan.</p>
        </div>
    </footer>

    <script src="script.js"></script>
    
    <!-- PWA Advanced Features -->
    <script>
        // Register Service Worker with update detection
        if ('serviceWorker' in navigator) {
            let refreshing = false;
            
            navigator.serviceWorker.addEventListener('controllerchange', () => {
                if (refreshing) return;
                refreshing = true;
                window.location.reload();
            });

            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('/sw.js');
                    console.log('[PWA] SW registered:', registration);

                    // Check for updates every 60 seconds
                    setInterval(() => {
                        registration.update();
                    }, 60000);

                    // Listen for updates
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        console.log('[PWA] New SW found, installing...');

                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                // New SW is installed, show update notification
                                showUpdateNotification(newWorker);
                            }
                        });
                    });
                } catch (error) {
                    console.error('[PWA] SW registration failed:', error);
                }
            });
        }

        // Show update notification
        function showUpdateNotification(worker) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #10b981;
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                display: flex;
                align-items: center;
                gap: 16px;
                animation: slideUp 0.3s ease;
            `;
            notification.innerHTML = `
                <span>üéâ Yangi versiya mavjud!</span>
                <button onclick="updateApp()" style="
                    background: white;
                    color: #10b981;
                    border: none;
                    padding: 8px 16px;
                    border-radius: 6px;
                    font-weight: 600;
                    cursor: pointer;
                ">Yangilash</button>
            `;
            document.body.appendChild(notification);

            window.updateApp = () => {
                worker.postMessage({ action: 'skipWaiting' });
            };
        }

        // Install prompt handling
        let deferredPrompt;
        const installBtn = document.getElementById('install-app-btn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            console.log('[PWA] beforeinstallprompt event fired');
            
            // Show install button with animation
            if (installBtn) {
                installBtn.style.display = 'inline-flex';
                installBtn.style.animation = 'pulse 2s infinite';
            }
        });

        if (installBtn) {
            installBtn.addEventListener('click', async () => {
                if (!deferredPrompt) {
                    console.log('[PWA] No install prompt available');
                    
                    // Check if already installed
                    if (window.matchMedia('(display-mode: standalone)').matches || 
                        window.navigator.standalone === true) {
                        showSuccessMessage('‚úÖ Ilova allaqachon o\'rnatilgan!');
                        return;
                    }
                    
                    // Try to detect browser and show specific instructions
                    const userAgent = navigator.userAgent.toLowerCase();
                    const isIOS = /iphone|ipad|ipod/.test(userAgent);
                    const isAndroid = /android/.test(userAgent);
                    const isChrome = /chrome/.test(userAgent) && !/edg/.test(userAgent);
                    
                    console.log('[PWA] User Agent:', userAgent);
                    console.log('[PWA] isIOS:', isIOS, 'isAndroid:', isAndroid, 'isChrome:', isChrome);
                    
                    if (isIOS) {
                        console.log('[PWA] Showing iOS instructions');
                        showIOSInstructions();
                    } else if (isAndroid) {
                        console.log('[PWA] Showing Android instructions');
                        // For Android, show Android instructions
                        showAndroidInstructions();
                    } else if (isChrome) {
                        console.log('[PWA] Chrome detected, waiting for prompt...');
                        // For Chrome Desktop, try to trigger install after a delay
                        showWaitingMessage();
                        setTimeout(() => {
                            const waitingMsg = document.getElementById('waiting-message');
                            if (waitingMsg) waitingMsg.remove();
                            
                            if (deferredPrompt) {
                                console.log('[PWA] Deferred prompt available, triggering install');
                                triggerInstall();
                            } else {
                                console.log('[PWA] No deferred prompt, showing desktop instructions');
                                // Chrome Desktop - show desktop instructions
                                showDesktopInstructions();
                            }
                        }, 1000);
                    } else {
                        console.log('[PWA] Other browser, showing desktop instructions');
                        // Other browsers - show general instructions
                        showDesktopInstructions();
                    }
                    return;
                }

                // Directly trigger install prompt
                triggerInstall();
            });
        }

        async function triggerInstall() {
            if (!deferredPrompt) {
                console.log('[PWA] No deferred prompt available');
                return;
            }

            try {
                console.log('[PWA] Showing install prompt...');
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                console.log(`[PWA] User response: ${outcome}`);
                
                if (outcome === 'accepted') {
                    console.log('[PWA] User accepted install');
                    installBtn.style.display = 'none';
                    showSuccessMessage('‚úÖ Ilova o\'rnatilmoqda...');
                } else {
                    console.log('[PWA] User dismissed install');
                    showInfoMessage('‚ÑπÔ∏è Ilovani keyinroq o\'rnatishingiz mumkin');
                }
                
                deferredPrompt = null;
            } catch (error) {
                console.error('[PWA] Install error:', error);
                showDesktopInstructions();
            }
        }

        // Show success message
        function showSuccessMessage(message) {
            const success = document.createElement('div');
            success.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #10b981;
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            success.textContent = message;
            document.body.appendChild(success);
            setTimeout(() => success.remove(), 3000);
        }

        // Show info message
        function showInfoMessage(message) {
            const info = document.createElement('div');
            info.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #3b82f6;
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            info.textContent = message;
            document.body.appendChild(info);
            setTimeout(() => info.remove(), 3000);
        }

        // Show waiting message
        function showWaitingMessage() {
            const waiting = document.createElement('div');
            waiting.id = 'waiting-message';
            waiting.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #f59e0b;
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            waiting.textContent = '‚è≥ Yuklanmoqda...';
            document.body.appendChild(waiting);
        }

        // Show iOS specific instructions
        function showIOSInstructions() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                inset: 0;
                background: rgba(0,0,0,0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                padding: 20px;
            `;
            modal.innerHTML = `
                <div style="
                    background: white;
                    border-radius: 16px;
                    padding: 32px;
                    max-width: 500px;
                    text-align: center;
                ">
                    <div style="font-size: 48px; margin-bottom: 16px;">üì±</div>
                    <h2 style="margin-bottom: 16px; color: #111;">iPhone/iPad uchun</h2>
                    <p style="color: #666; margin-bottom: 24px;">
                        Safari brauzerida quyidagi qadamlarni bajaring:
                    </p>
                    <div style="text-align: left; background: #f3f4f6; padding: 20px; border-radius: 8px; margin-bottom: 24px;">
                        <p style="font-size: 16px; color: #111; margin-bottom: 12px;">
                            <strong>1.</strong> Pastdagi <strong>Share</strong> tugmasiga bosing 
                            <span style="font-size: 24px;">‚¨ÜÔ∏è</span>
                        </p>
                        <p style="font-size: 16px; color: #111; margin-bottom: 12px;">
                            <strong>2.</strong> <strong>"Add to Home Screen"</strong> ni toping va bosing
                        </p>
                        <p style="font-size: 16px; color: #111;">
                            <strong>3.</strong> <strong>"Add"</strong> tugmasini bosing
                        </p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" style="
                        background: #10b981;
                        color: white;
                        border: none;
                        padding: 12px 32px;
                        border-radius: 8px;
                        font-weight: 600;
                        cursor: pointer;
                        font-size: 16px;
                    ">Tushundim</button>
                </div>
            `;
            document.body.appendChild(modal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.remove();
            });
        }

        // Show Android specific instructions
        function showAndroidInstructions() {
            const waitingMsg = document.getElementById('waiting-message');
            if (waitingMsg) waitingMsg.remove();

            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                inset: 0;
                background: rgba(0,0,0,0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                padding: 20px;
            `;
            modal.innerHTML = `
                <div style="
                    background: white;
                    border-radius: 16px;
                    padding: 32px;
                    max-width: 500px;
                    text-align: center;
                ">
                    <div style="font-size: 48px; margin-bottom: 16px;">üì±</div>
                    <h2 style="margin-bottom: 16px; color: #111;">Android uchun</h2>
                    <p style="color: #666; margin-bottom: 24px;">
                        Chrome brauzerida quyidagi qadamlarni bajaring:
                    </p>
                    <div style="text-align: left; background: #f3f4f6; padding: 20px; border-radius: 8px; margin-bottom: 24px;">
                        <p style="font-size: 16px; color: #111; margin-bottom: 12px;">
                            <strong>1.</strong> O'ng yuqoridagi <strong>Menu</strong> tugmasiga bosing 
                            <span style="font-size: 24px;">‚ãÆ</span>
                        </p>
                        <p style="font-size: 16px; color: #111; margin-bottom: 12px;">
                            <strong>2.</strong> <strong>"Add to Home screen"</strong> yoki <strong>"Install app"</strong> ni tanlang
                        </p>
                        <p style="font-size: 16px; color: #111;">
                            <strong>3.</strong> <strong>"Install"</strong> tugmasini bosing
                        </p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" style="
                        background: #10b981;
                        color: white;
                        border: none;
                        padding: 12px 32px;
                        border-radius: 8px;
                        font-weight: 600;
                        cursor: pointer;
                        font-size: 16px;
                    ">Tushundim</button>
                </div>
            `;
            document.body.appendChild(modal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.remove();
            });
        }

        // Show Desktop specific instructions (Chrome/Edge/Brave)
        function showDesktopInstructions() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                inset: 0;
                background: rgba(0,0,0,0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                padding: 20px;
            `;
            modal.innerHTML = `
                <div style="
                    background: white;
                    border-radius: 16px;
                    padding: 32px;
                    max-width: 500px;
                    text-align: center;
                ">
                    <div style="font-size: 48px; margin-bottom: 16px;">üíª</div>
                    <h2 style="margin-bottom: 16px; color: #111;">Desktop uchun</h2>
                    <p style="color: #666; margin-bottom: 24px;">
                        Chrome yoki Edge brauzerida quyidagi qadamlarni bajaring:
                    </p>
                    <div style="text-align: left; background: #f3f4f6; padding: 20px; border-radius: 8px; margin-bottom: 24px;">
                        <p style="font-size: 16px; color: #111; margin-bottom: 12px;">
                            <strong>1.</strong> Address bar'da <strong>"Install"</strong> icon'ga bosing
                        </p>
                        <p style="font-size: 16px; color: #111; margin-bottom: 12px;">
                            <strong>2.</strong> Yoki Menu (‚ãÆ) ‚Üí <strong>"Install Bolajon Med"</strong>
                        </p>
                        <p style="font-size: 16px; color: #111;">
                            <strong>3.</strong> <strong>"Install"</strong> tugmasini bosing
                        </p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" style="
                        background: #10b981;
                        color: white;
                        border: none;
                        padding: 12px 32px;
                        border-radius: 8px;
                        font-weight: 600;
                        cursor: pointer;
                        font-size: 16px;
                    ">Tushundim</button>
                </div>
            `;
            document.body.appendChild(modal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.remove();
            });
        }

        // App installed event
        window.addEventListener('appinstalled', () => {
            console.log('[PWA] App installed successfully');
            if (installBtn) {
                installBtn.style.display = 'none';
            }
            
            // Show success message with icon
            const success = document.createElement('div');
            success.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: white;
                color: #111;
                padding: 32px;
                border-radius: 16px;
                box-shadow: 0 8px 24px rgba(0,0,0,0.2);
                z-index: 10000;
                text-align: center;
                animation: scaleIn 0.3s ease;
            `;
            success.innerHTML = `
                <div style="font-size: 64px; margin-bottom: 16px;">üéâ</div>
                <h2 style="margin-bottom: 8px; color: #10b981;">Muvaffaqiyatli!</h2>
                <p style="color: #666;">Bolajon Med ilovasi o'rnatildi</p>
            `;
            document.body.appendChild(success);
            setTimeout(() => success.remove(), 3000);
        });

        // Check if app is already installed
        if (window.matchMedia('(display-mode: standalone)').matches) {
            console.log('[PWA] App is running in standalone mode');
            if (installBtn) {
                installBtn.style.display = 'none';
            }
        }

        // Online/Offline detection
        window.addEventListener('online', () => {
            console.log('[PWA] Back online');
            showConnectionStatus('‚úÖ Internet aloqasi qayta tiklandi', '#10b981');
        });

        window.addEventListener('offline', () => {
            console.log('[PWA] Gone offline');
            showConnectionStatus('‚ö†Ô∏è Internet aloqasi yo\'q - Offline rejim', '#f59e0b');
        });

        function showConnectionStatus(message, color) {
            const status = document.createElement('div');
            status.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${color};
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            status.textContent = message;
            document.body.appendChild(status);
            setTimeout(() => status.remove(), 3000);
        }

        // Add animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideUp {
                from { transform: translate(-50%, 100px); opacity: 0; }
                to { transform: translate(-50%, 0); opacity: 1; }
            }
            @keyframes slideIn {
                from { transform: translateX(100px); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes pulse {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.05); }
            }
            @keyframes scaleIn {
                from { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
                to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
